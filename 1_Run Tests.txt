2025-08-17T19:54:23.3511790Z Current runner version: '2.327.1'
2025-08-17T19:54:23.3534206Z ##[group]Runner Image Provisioner
2025-08-17T19:54:23.3535013Z Hosted Compute Agent
2025-08-17T19:54:23.3535528Z Version: 20250812.370
2025-08-17T19:54:23.3536207Z Commit: 4a2b2bf7520004e3e907c2150c8cabe342a3da32
2025-08-17T19:54:23.3536850Z Build Date: 2025-08-12T16:08:14Z
2025-08-17T19:54:23.3537432Z ##[endgroup]
2025-08-17T19:54:23.3537989Z ##[group]Operating System
2025-08-17T19:54:23.3538558Z Ubuntu
2025-08-17T19:54:23.3539036Z 24.04.2
2025-08-17T19:54:23.3539488Z LTS
2025-08-17T19:54:23.3540000Z ##[endgroup]
2025-08-17T19:54:23.3540496Z ##[group]Runner Image
2025-08-17T19:54:23.3541140Z Image: ubuntu-24.04
2025-08-17T19:54:23.3541666Z Version: 20250810.1.0
2025-08-17T19:54:23.3542708Z Included Software: https://github.com/actions/runner-images/blob/ubuntu24/20250810.1/images/ubuntu/Ubuntu2404-Readme.md
2025-08-17T19:54:23.3544620Z Image Release: https://github.com/actions/runner-images/releases/tag/ubuntu24%2F20250810.1
2025-08-17T19:54:23.3545611Z ##[endgroup]
2025-08-17T19:54:23.3546769Z ##[group]GITHUB_TOKEN Permissions
2025-08-17T19:54:23.3548739Z Contents: read
2025-08-17T19:54:23.3549264Z Metadata: read
2025-08-17T19:54:23.3549812Z Packages: read
2025-08-17T19:54:23.3550299Z ##[endgroup]
2025-08-17T19:54:23.3552234Z Secret source: Actions
2025-08-17T19:54:23.3552976Z Prepare workflow directory
2025-08-17T19:54:23.4118316Z Prepare all required actions
2025-08-17T19:54:23.4154789Z Getting action download info
2025-08-17T19:54:23.8036031Z Download action repository 'actions/checkout@v4' (SHA:08eba0b27e820071cde6df949e0beb9ba4906955)
2025-08-17T19:54:24.6053350Z Download action repository 'actions/setup-python@v4' (SHA:7f4fc3e22c37d6ff65e88745f38bd3157c663f7c)
2025-08-17T19:54:25.4883079Z Download action repository 'aws-actions/setup-sam@v2' (SHA:f664fad9e12492edfc187a31f575537dfbb0ff63)
2025-08-17T19:54:26.2271206Z Download action repository 'actions/upload-artifact@v4' (SHA:ea165f8d65b6e75b540449e92b4886f43607fa02)
2025-08-17T19:54:26.4055839Z Complete job name: Run Tests
2025-08-17T19:54:26.4628639Z ##[group]Run actions/checkout@v4
2025-08-17T19:54:26.4629219Z with:
2025-08-17T19:54:26.4629440Z   repository: JimothyJohn/product-selector
2025-08-17T19:54:26.4629876Z   token: ***
2025-08-17T19:54:26.4630057Z   ssh-strict: true
2025-08-17T19:54:26.4630233Z   ssh-user: git
2025-08-17T19:54:26.4630426Z   persist-credentials: true
2025-08-17T19:54:26.4630630Z   clean: true
2025-08-17T19:54:26.4630829Z   sparse-checkout-cone-mode: true
2025-08-17T19:54:26.4631068Z   fetch-depth: 1
2025-08-17T19:54:26.4631254Z   fetch-tags: false
2025-08-17T19:54:26.4631450Z   show-progress: true
2025-08-17T19:54:26.4631630Z   lfs: false
2025-08-17T19:54:26.4631791Z   submodules: false
2025-08-17T19:54:26.4631976Z   set-safe-directory: true
2025-08-17T19:54:26.4632359Z env:
2025-08-17T19:54:26.4632526Z   PYTHONPATH: app
2025-08-17T19:54:26.4632727Z   AWS_DEFAULT_REGION: us-east-1
2025-08-17T19:54:26.4632954Z   TEST_API_KEY: test-api-key-12345
2025-08-17T19:54:26.4633202Z   LOG_LEVEL: DEBUG
2025-08-17T19:54:26.4633427Z ##[endgroup]
2025-08-17T19:54:26.5750307Z Syncing repository: JimothyJohn/product-selector
2025-08-17T19:54:26.5752360Z ##[group]Getting Git version info
2025-08-17T19:54:26.5753119Z Working directory is '/home/runner/work/product-selector/product-selector'
2025-08-17T19:54:26.5754383Z [command]/usr/bin/git version
2025-08-17T19:54:26.5806317Z git version 2.50.1
2025-08-17T19:54:26.5832179Z ##[endgroup]
2025-08-17T19:54:26.5845174Z Temporarily overriding HOME='/home/runner/work/_temp/a7e17a5a-5f3f-4b9c-ab20-26b9718a6741' before making global git config changes
2025-08-17T19:54:26.5846053Z Adding repository directory to the temporary git global config as a safe directory
2025-08-17T19:54:26.5850433Z [command]/usr/bin/git config --global --add safe.directory /home/runner/work/product-selector/product-selector
2025-08-17T19:54:26.5891409Z Deleting the contents of '/home/runner/work/product-selector/product-selector'
2025-08-17T19:54:26.5894844Z ##[group]Initializing the repository
2025-08-17T19:54:26.5898843Z [command]/usr/bin/git init /home/runner/work/product-selector/product-selector
2025-08-17T19:54:26.6040367Z hint: Using 'master' as the name for the initial branch. This default branch name
2025-08-17T19:54:26.6040981Z hint: is subject to change. To configure the initial branch name to use in all
2025-08-17T19:54:26.6041504Z hint: of your new repositories, which will suppress this warning, call:
2025-08-17T19:54:26.6041878Z hint:
2025-08-17T19:54:26.6042189Z hint: 	git config --global init.defaultBranch <name>
2025-08-17T19:54:26.6042511Z hint:
2025-08-17T19:54:26.6042798Z hint: Names commonly chosen instead of 'master' are 'main', 'trunk' and
2025-08-17T19:54:26.6043315Z hint: 'development'. The just-created branch can be renamed via this command:
2025-08-17T19:54:26.6043942Z hint:
2025-08-17T19:54:26.6044287Z hint: 	git branch -m <name>
2025-08-17T19:54:26.6044522Z hint:
2025-08-17T19:54:26.6044850Z hint: Disable this message with "git config set advice.defaultBranchName false"
2025-08-17T19:54:26.6048069Z Initialized empty Git repository in /home/runner/work/product-selector/product-selector/.git/
2025-08-17T19:54:26.6058814Z [command]/usr/bin/git remote add origin https://github.com/JimothyJohn/product-selector
2025-08-17T19:54:26.6091191Z ##[endgroup]
2025-08-17T19:54:26.6091575Z ##[group]Disabling automatic garbage collection
2025-08-17T19:54:26.6095716Z [command]/usr/bin/git config --local gc.auto 0
2025-08-17T19:54:26.6126412Z ##[endgroup]
2025-08-17T19:54:26.6126762Z ##[group]Setting up auth
2025-08-17T19:54:26.6133035Z [command]/usr/bin/git config --local --name-only --get-regexp core\.sshCommand
2025-08-17T19:54:26.6162362Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'core\.sshCommand' && git config --local --unset-all 'core.sshCommand' || :"
2025-08-17T19:54:26.6449131Z [command]/usr/bin/git config --local --name-only --get-regexp http\.https\:\/\/github\.com\/\.extraheader
2025-08-17T19:54:26.6477613Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'http\.https\:\/\/github\.com\/\.extraheader' && git config --local --unset-all 'http.https://github.com/.extraheader' || :"
2025-08-17T19:54:26.6692770Z [command]/usr/bin/git config --local http.https://github.com/.extraheader AUTHORIZATION: basic ***
2025-08-17T19:54:26.6734710Z ##[endgroup]
2025-08-17T19:54:26.6735390Z ##[group]Fetching the repository
2025-08-17T19:54:26.6743453Z [command]/usr/bin/git -c protocol.version=2 fetch --no-tags --prune --no-recurse-submodules --depth=1 origin +1ef96da17e4eba4dc418d88451c084da7d43a41f:refs/remotes/origin/dev
2025-08-17T19:54:27.1260217Z From https://github.com/JimothyJohn/product-selector
2025-08-17T19:54:27.1261084Z  * [new ref]         1ef96da17e4eba4dc418d88451c084da7d43a41f -> origin/dev
2025-08-17T19:54:27.1292409Z ##[endgroup]
2025-08-17T19:54:27.1303422Z ##[group]Determining the checkout info
2025-08-17T19:54:27.1304227Z ##[endgroup]
2025-08-17T19:54:27.1304688Z [command]/usr/bin/git sparse-checkout disable
2025-08-17T19:54:27.1346209Z [command]/usr/bin/git config --local --unset-all extensions.worktreeConfig
2025-08-17T19:54:27.1378990Z ##[group]Checking out the ref
2025-08-17T19:54:27.1385247Z [command]/usr/bin/git checkout --progress --force -B dev refs/remotes/origin/dev
2025-08-17T19:54:27.1480061Z Switched to a new branch 'dev'
2025-08-17T19:54:27.1482720Z branch 'dev' set up to track 'origin/dev'.
2025-08-17T19:54:27.1489445Z ##[endgroup]
2025-08-17T19:54:27.1527864Z [command]/usr/bin/git log -1 --format=%H
2025-08-17T19:54:27.1549796Z 1ef96da17e4eba4dc418d88451c084da7d43a41f
2025-08-17T19:54:27.1755332Z ##[group]Run actions/setup-python@v4
2025-08-17T19:54:27.1755619Z with:
2025-08-17T19:54:27.1755803Z   python-version: 3.11
2025-08-17T19:54:27.1756011Z   check-latest: false
2025-08-17T19:54:27.1756357Z   token: ***
2025-08-17T19:54:27.1756549Z   update-environment: true
2025-08-17T19:54:27.1756775Z   allow-prereleases: false
2025-08-17T19:54:27.1757154Z env:
2025-08-17T19:54:27.1757318Z   PYTHONPATH: app
2025-08-17T19:54:27.1757513Z   AWS_DEFAULT_REGION: us-east-1
2025-08-17T19:54:27.1757751Z   TEST_API_KEY: test-api-key-12345
2025-08-17T19:54:27.1757978Z   LOG_LEVEL: DEBUG
2025-08-17T19:54:27.1758150Z ##[endgroup]
2025-08-17T19:54:27.3422383Z ##[group]Installed versions
2025-08-17T19:54:27.3545292Z Successfully set up CPython (3.11.13)
2025-08-17T19:54:27.3545991Z ##[endgroup]
2025-08-17T19:54:27.3651885Z ##[group]Run curl -LsSf https://astral.sh/uv/install.sh | sh
2025-08-17T19:54:27.3652382Z [36;1mcurl -LsSf https://astral.sh/uv/install.sh | sh[0m
2025-08-17T19:54:27.3652720Z [36;1mecho "$HOME/.local/bin" >> $GITHUB_PATH[0m
2025-08-17T19:54:27.3927494Z shell: /usr/bin/bash -e {0}
2025-08-17T19:54:27.3927747Z env:
2025-08-17T19:54:27.3927925Z   PYTHONPATH: app
2025-08-17T19:54:27.3928126Z   AWS_DEFAULT_REGION: us-east-1
2025-08-17T19:54:27.3928382Z   TEST_API_KEY: test-api-key-12345
2025-08-17T19:54:27.3928631Z   LOG_LEVEL: DEBUG
2025-08-17T19:54:27.3928904Z   pythonLocation: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:27.3929329Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib/pkgconfig
2025-08-17T19:54:27.3929737Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:27.3930093Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:27.3930449Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:27.3930847Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib
2025-08-17T19:54:27.3931146Z ##[endgroup]
2025-08-17T19:54:27.9173818Z downloading uv 0.8.11 x86_64-unknown-linux-gnu
2025-08-17T19:54:28.2414571Z no checksums to verify
2025-08-17T19:54:28.5907683Z installing to /home/runner/.local/bin
2025-08-17T19:54:28.5949731Z   uv
2025-08-17T19:54:28.5970855Z   uvx
2025-08-17T19:54:28.5971211Z everything's installed!
2025-08-17T19:54:28.6080585Z ##[group]Run aws-actions/setup-sam@v2
2025-08-17T19:54:28.6080851Z with:
2025-08-17T19:54:28.6081033Z   use-installer: true
2025-08-17T19:54:28.6081229Z env:
2025-08-17T19:54:28.6081382Z   PYTHONPATH: app
2025-08-17T19:54:28.6081583Z   AWS_DEFAULT_REGION: us-east-1
2025-08-17T19:54:28.6081813Z   TEST_API_KEY: test-api-key-12345
2025-08-17T19:54:28.6082032Z   LOG_LEVEL: DEBUG
2025-08-17T19:54:28.6082286Z   pythonLocation: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:28.6082679Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib/pkgconfig
2025-08-17T19:54:28.6083057Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:28.6083381Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:28.6083965Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:28.6084306Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib
2025-08-17T19:54:28.6084587Z ##[endgroup]
2025-08-17T19:54:29.9960339Z [command]/usr/bin/unzip -o -q /home/runner/work/_temp/1b479325-eeb5-4f18-bcb1-281b5a462163
2025-08-17T19:54:35.3831600Z Cached AWS SAM CLI 1.142.1 to /opt/hostedtoolcache/sam/1.142.1/x64
2025-08-17T19:54:35.3978255Z ##[group]Run cd lambda
2025-08-17T19:54:35.3978524Z [36;1mcd lambda[0m
2025-08-17T19:54:35.3978698Z [36;1m[0m
2025-08-17T19:54:35.3978863Z [36;1m# Format code[0m
2025-08-17T19:54:35.3979063Z [36;1mecho "Formatting code..."[0m
2025-08-17T19:54:35.3979308Z [36;1muv run ruff format app[0m
2025-08-17T19:54:35.3979528Z [36;1m[0m
2025-08-17T19:54:35.3979742Z [36;1m# Validate SAM template[0m
2025-08-17T19:54:35.3979994Z [36;1mecho "Validating SAM template..."[0m
2025-08-17T19:54:35.3980250Z [36;1msam validate --lint[0m
2025-08-17T19:54:35.3980454Z [36;1m[0m
2025-08-17T19:54:35.3980619Z [36;1m# Build the SAM application[0m
2025-08-17T19:54:35.3980871Z [36;1mecho "Building SAM application..."[0m
2025-08-17T19:54:35.3981105Z [36;1msam build[0m
2025-08-17T19:54:35.4021732Z shell: /usr/bin/bash -e {0}
2025-08-17T19:54:35.4021957Z env:
2025-08-17T19:54:35.4022123Z   PYTHONPATH: app
2025-08-17T19:54:35.4022474Z   AWS_DEFAULT_REGION: us-east-1
2025-08-17T19:54:35.4022744Z   TEST_API_KEY: test-api-key-12345
2025-08-17T19:54:35.4022970Z   LOG_LEVEL: DEBUG
2025-08-17T19:54:35.4023214Z   pythonLocation: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:35.4023861Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib/pkgconfig
2025-08-17T19:54:35.4024251Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:35.4024583Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:35.4024919Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:35.4025269Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib
2025-08-17T19:54:35.4025561Z ##[endgroup]
2025-08-17T19:54:35.4084233Z Formatting code...
2025-08-17T19:54:35.8815126Z Using CPython 3.11.13 interpreter at: /opt/hostedtoolcache/Python/3.11.13/x64/bin/python3
2025-08-17T19:54:35.8816121Z Creating virtual environment at: /home/runner/work/product-selector/product-selector/.venv
2025-08-17T19:54:35.9369609Z Downloading pygments (1.2MiB)
2025-08-17T19:54:35.9430441Z Downloading ruff (12.4MiB)
2025-08-17T19:54:35.9437013Z Downloading botocore (13.4MiB)
2025-08-17T19:54:36.1035185Z  Downloading ruff
2025-08-17T19:54:36.1580548Z  Downloading pygments
2025-08-17T19:54:36.3836763Z  Downloading botocore
2025-08-17T19:54:36.4627939Z Installed 25 packages in 78ms
2025-08-17T19:54:36.4740205Z 5 files left unchanged
2025-08-17T19:54:36.4793455Z Validating SAM template...
2025-08-17T19:54:37.0244502Z 
2025-08-17T19:54:37.0245169Z 	SAM CLI now collects telemetry to better understand customer needs.
2025-08-17T19:54:37.0245759Z 
2025-08-17T19:54:37.0246092Z 	You can OPT OUT and disable telemetry collection by setting the
2025-08-17T19:54:37.0246878Z 	environment variable SAM_CLI_TELEMETRY=0 in your shell.
2025-08-17T19:54:37.0247497Z 	Thanks for your help!
2025-08-17T19:54:37.0247769Z 
2025-08-17T19:54:37.0248619Z 	Learn More: https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-telemetry.html
2025-08-17T19:54:37.0249360Z 
2025-08-17T19:54:38.2986410Z /home/runner/work/product-selector/product-selector/lambda/template.yaml is a valid SAM Template
2025-08-17T19:54:38.7582599Z Building SAM application...
2025-08-17T19:54:39.4114143Z Starting Build use cache
2025-08-17T19:54:39.4968139Z Manifest file is changed (new hash: efe739f69ef3d0bf82368bb66d718536) or dependency folder (.aws-sam/deps/6cfe965b-04aa-4fd5-b5af-065b067229e4) is missing for (ProductSelectorFunction), downloading dependencies and copying/building source
2025-08-17T19:54:39.4970517Z Building codeuri: /home/runner/work/product-selector/product-selector/lambda/app runtime: python3.11 architecture: x86_64 functions: ProductSelectorFunction
2025-08-17T19:54:39.5199005Z  Running PythonPipBuilder:CleanUp
2025-08-17T19:54:39.5199570Z  Running PythonPipBuilder:ResolveDependencies
2025-08-17T19:54:43.9834183Z  Running PythonPipBuilder:CopySource
2025-08-17T19:54:44.3480559Z  Running PythonPipBuilder:CopySource
2025-08-17T19:54:44.3600249Z 
2025-08-17T19:54:44.3600773Z Build Succeeded
2025-08-17T19:54:44.3601031Z 
2025-08-17T19:54:44.3601139Z Built Artifacts  : .aws-sam/build
2025-08-17T19:54:44.3601447Z Built Template   : .aws-sam/build/template.yaml
2025-08-17T19:54:44.3601666Z 
2025-08-17T19:54:44.3601919Z Commands you can use next
2025-08-17T19:54:44.3602253Z =========================
2025-08-17T19:54:44.3602637Z [*] Validate SAM template: sam validate
2025-08-17T19:54:44.3603115Z [*] Invoke Function: sam local invoke
2025-08-17T19:54:44.3603969Z [*] Test Function in the Cloud: sam sync --stack-name {{stack-name}} --watch
2025-08-17T19:54:44.3604612Z [*] Deploy: sam deploy --guided
2025-08-17T19:54:44.6141021Z ##[group]Run cd lambda
2025-08-17T19:54:44.6141263Z [36;1mcd lambda[0m
2025-08-17T19:54:44.6141459Z [36;1mecho "Running unit tests..."[0m
2025-08-17T19:54:44.6141941Z [36;1mPYTHONPATH="app" uv run pytest tests/unit -v --tb=short --junit-xml=test-results-unit.xml[0m
2025-08-17T19:54:44.6184188Z shell: /usr/bin/bash -e {0}
2025-08-17T19:54:44.6184574Z env:
2025-08-17T19:54:44.6184740Z   PYTHONPATH: app
2025-08-17T19:54:44.6184938Z   AWS_DEFAULT_REGION: us-east-1
2025-08-17T19:54:44.6185201Z   TEST_API_KEY: test-api-key-12345
2025-08-17T19:54:44.6185425Z   LOG_LEVEL: DEBUG
2025-08-17T19:54:44.6185669Z   pythonLocation: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:44.6186063Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib/pkgconfig
2025-08-17T19:54:44.6186434Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:44.6186789Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:44.6187160Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:44.6187492Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib
2025-08-17T19:54:44.6187773Z ##[endgroup]
2025-08-17T19:54:44.6246878Z Running unit tests...
2025-08-17T19:54:45.6248559Z ============================= test session starts ==============================
2025-08-17T19:54:45.6249723Z platform linux -- Python 3.11.13, pytest-8.4.1, pluggy-1.6.0 -- /home/runner/work/product-selector/product-selector/.venv/bin/python
2025-08-17T19:54:45.6250656Z cachedir: .pytest_cache
2025-08-17T19:54:45.6251172Z rootdir: /home/runner/work/product-selector/product-selector
2025-08-17T19:54:45.6251753Z configfile: pyproject.toml
2025-08-17T19:54:45.6252142Z plugins: anyio-4.10.0
2025-08-17T19:54:46.1542278Z collecting ... collected 55 items
2025-08-17T19:54:46.1542646Z 
2025-08-17T19:54:46.1614192Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_successful_get_all_gearboxes PASSED [  1%]
2025-08-17T19:54:46.1625981Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_post_invalid_operation PASSED [  3%]
2025-08-17T19:54:46.1640799Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_missing_api_key PASSED [  5%]
2025-08-17T19:54:46.1655449Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_empty_api_key PASSED [  7%]
2025-08-17T19:54:46.1670694Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_whitespace_api_key PASSED [  9%]
2025-08-17T19:54:46.1684615Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_missing_headers PASSED [ 10%]
2025-08-17T19:54:46.1695912Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_malformed_json_body PASSED [ 12%]
2025-08-17T19:54:46.1709495Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_none_body PASSED [ 14%]
2025-08-17T19:54:46.1723105Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_get_with_category_filter PASSED [ 16%]
2025-08-17T19:54:46.1737347Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_get_with_type_filter PASSED [ 18%]
2025-08-17T19:54:46.1751270Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_get_with_multiple_filters PASSED [ 20%]
2025-08-17T19:54:46.1767981Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_get_no_results_with_filter PASSED [ 21%]
2025-08-17T19:54:46.1781427Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_case_sensitive_headers PASSED [ 23%]
2025-08-17T19:54:46.1792003Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_internal_server_error PASSED [ 25%]
2025-08-17T19:54:46.1805066Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_minimal_valid_event PASSED [ 27%]
2025-08-17T19:54:46.1815954Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_unsupported_method PASSED [ 29%]
2025-08-17T19:54:46.1829327Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_create_gearbox_success PASSED [ 30%]
2025-08-17T19:54:46.1840468Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_create_gearbox_missing_fields PASSED [ 32%]
2025-08-17T19:54:46.1851864Z tests/unit/test_lambda_handler.py::TestLambdaHandler::test_post_no_body PASSED [ 34%]
2025-08-17T19:54:46.1864009Z tests/unit/test_lambda_handler.py::TestResponseFormat::test_success_response_format PASSED [ 36%]
2025-08-17T19:54:46.1876298Z tests/unit/test_lambda_handler.py::TestResponseFormat::test_error_response_format PASSED [ 38%]
2025-08-17T19:54:46.1884464Z tests/unit/test_lambda_handler.py::TestHelperFunctions::test_convert_dynamodb_item_string PASSED [ 40%]
2025-08-17T19:54:46.1892486Z tests/unit/test_lambda_handler.py::TestHelperFunctions::test_convert_dynamodb_item_number_int PASSED [ 41%]
2025-08-17T19:54:46.1900656Z tests/unit/test_lambda_handler.py::TestHelperFunctions::test_convert_dynamodb_item_number_float PASSED [ 43%]
2025-08-17T19:54:46.1908719Z tests/unit/test_lambda_handler.py::TestHelperFunctions::test_convert_dynamodb_item_boolean PASSED [ 45%]
2025-08-17T19:54:46.1918379Z tests/unit/test_lambda_handler.py::TestHelperFunctions::test_convert_dynamodb_item_null PASSED [ 47%]
2025-08-17T19:54:46.1926406Z tests/unit/test_lambda_handler.py::TestHelperFunctions::test_convert_dynamodb_item_list PASSED [ 49%]
2025-08-17T19:54:46.1934422Z tests/unit/test_lambda_handler.py::TestHelperFunctions::test_convert_dynamodb_item_map PASSED [ 50%]
2025-08-17T19:54:46.1942439Z tests/unit/test_lambda_handler.py::TestHelperFunctions::test_convert_dynamodb_item_string_set PASSED [ 52%]
2025-08-17T19:54:46.1950973Z tests/unit/test_lambda_handler.py::TestHelperFunctions::test_convert_dynamodb_item_number_set PASSED [ 54%]
2025-08-17T19:54:46.1959155Z tests/unit/test_lambda_handler.py::TestHelperFunctions::test_convert_dynamodb_item_unknown_type PASSED [ 56%]
2025-08-17T19:54:46.1967109Z tests/unit/test_lambda_handler.py::TestFilterItems::test_filter_no_filters PASSED [ 58%]
2025-08-17T19:54:46.1975177Z tests/unit/test_lambda_handler.py::TestFilterItems::test_filter_category_gearbox_item PASSED [ 60%]
2025-08-17T19:54:46.1983151Z tests/unit/test_lambda_handler.py::TestFilterItems::test_filter_category_category_item PASSED [ 61%]
2025-08-17T19:54:46.1991016Z tests/unit/test_lambda_handler.py::TestFilterItems::test_filter_manufacturer PASSED [ 63%]
2025-08-17T19:54:46.1999544Z tests/unit/test_lambda_handler.py::TestFilterItems::test_filter_price_range PASSED [ 65%]
2025-08-17T19:54:46.2007787Z tests/unit/test_lambda_handler.py::TestFilterItems::test_filter_min_torque PASSED [ 67%]
2025-08-17T19:54:46.2015967Z tests/unit/test_lambda_handler.py::TestFilterItems::test_filter_min_performance PASSED [ 69%]
2025-08-17T19:54:46.2023952Z tests/unit/test_lambda_handler.py::TestFilterItems::test_filter_invalid_torque PASSED [ 70%]
2025-08-17T19:54:46.2031950Z tests/unit/test_lambda_handler.py::TestFilterItems::test_filter_multiple_conditions PASSED [ 72%]
2025-08-17T19:54:46.2042980Z tests/unit/test_lambda_handler.py::TestCRUDOperations::test_create_gearbox_complete PASSED [ 74%]
2025-08-17T19:54:46.2055078Z tests/unit/test_lambda_handler.py::TestCRUDOperations::test_create_gearbox_duplicate PASSED [ 76%]
2025-08-17T19:54:46.2066062Z tests/unit/test_lambda_handler.py::TestCRUDOperations::test_update_gearbox_success PASSED [ 78%]
2025-08-17T19:54:46.2077055Z tests/unit/test_lambda_handler.py::TestCRUDOperations::test_update_gearbox_not_found PASSED [ 80%]
2025-08-17T19:54:46.2085617Z tests/unit/test_lambda_handler.py::TestCRUDOperations::test_update_gearbox_no_updates PASSED [ 81%]
2025-08-17T19:54:46.2096540Z tests/unit/test_lambda_handler.py::TestCRUDOperations::test_update_gearbox_protected_fields PASSED [ 83%]
2025-08-17T19:54:46.2107155Z tests/unit/test_lambda_handler.py::TestCRUDOperations::test_delete_gearbox_success PASSED [ 85%]
2025-08-17T19:54:46.2119136Z tests/unit/test_lambda_handler.py::TestCRUDOperations::test_delete_gearbox_not_found PASSED [ 87%]
2025-08-17T19:54:46.2127346Z tests/unit/test_lambda_handler.py::TestCRUDOperations::test_delete_gearbox_no_id PASSED [ 89%]
2025-08-17T19:54:46.2139689Z tests/unit/test_lambda_handler.py::TestErrorHandling::test_dynamodb_client_error PASSED [ 90%]
2025-08-17T19:54:46.2152444Z tests/unit/test_lambda_handler.py::TestErrorHandling::test_unexpected_exception PASSED [ 92%]
2025-08-17T19:54:46.2163532Z tests/unit/test_lambda_handler.py::TestErrorHandling::test_pagination_handling PASSED [ 94%]
2025-08-17T19:54:46.2178523Z tests/unit/test_lambda_handler.py::TestLoggingConfiguration::test_configure_logging_default PASSED [ 96%]
2025-08-17T19:54:46.2192418Z tests/unit/test_lambda_handler.py::TestLoggingConfiguration::test_configure_logging_debug PASSED [ 98%]
2025-08-17T19:54:46.2798629Z tests/unit/test_lambda_handler.py::TestLoggingConfiguration::test_configure_logging_invalid_level PASSED [100%]
2025-08-17T19:54:46.2799403Z 
2025-08-17T19:54:46.2799913Z - generated xml file: /home/runner/work/product-selector/product-selector/lambda/test-results-unit.xml -
2025-08-17T19:54:46.2800755Z ============================== 55 passed in 0.60s ==============================
2025-08-17T19:54:46.3449719Z ##[group]Run cd lambda
2025-08-17T19:54:46.3449980Z [36;1mcd lambda[0m
2025-08-17T19:54:46.3450149Z [36;1m[0m
2025-08-17T19:54:46.3450328Z [36;1mecho "Starting SAM local API..."[0m
2025-08-17T19:54:46.3450594Z [36;1msam local start-api --port 3000 &[0m
2025-08-17T19:54:46.3450844Z [36;1mSAM_PID=$![0m
2025-08-17T19:54:46.3451015Z [36;1m[0m
2025-08-17T19:54:46.3451187Z [36;1m# Wait for the API to be ready[0m
2025-08-17T19:54:46.3451467Z [36;1mecho "Waiting for local API to start..."[0m
2025-08-17T19:54:46.3451733Z [36;1mfor i in {1..30}; do[0m
2025-08-17T19:54:46.3452064Z [36;1m  if curl -s http://localhost:3000 > /dev/null 2>&1 || [ $? -eq 7 ]; then[0m
2025-08-17T19:54:46.3452409Z [36;1m    echo "Local API is ready"[0m
2025-08-17T19:54:46.3452641Z [36;1m    break[0m
2025-08-17T19:54:46.3452812Z [36;1m  fi[0m
2025-08-17T19:54:46.3453003Z [36;1m  echo "Waiting for API... ($i/30)"[0m
2025-08-17T19:54:46.3453236Z [36;1m  sleep 2[0m
2025-08-17T19:54:46.3453478Z [36;1mdone[0m
2025-08-17T19:54:46.3453877Z [36;1m[0m
2025-08-17T19:54:46.3454076Z [36;1m# Run integration tests against local API[0m
2025-08-17T19:54:46.3454401Z [36;1mecho "Running integration tests against local API..."[0m
2025-08-17T19:54:46.3455043Z [36;1mPYTHONPATH="app" TEST_API_KEY="$TEST_API_KEY" uv run pytest tests/integration/test_local_api.py -v --tb=short --junit-xml=test-results-integration.xml[0m
2025-08-17T19:54:46.3455617Z [36;1m[0m
2025-08-17T19:54:46.3455776Z [36;1m# Stop the local API[0m
2025-08-17T19:54:46.3456003Z [36;1mecho "Stopping local API..."[0m
2025-08-17T19:54:46.3456232Z [36;1mkill $SAM_PID || true[0m
2025-08-17T19:54:46.3456456Z [36;1mwait $SAM_PID 2>/dev/null || true[0m
2025-08-17T19:54:46.3496619Z shell: /usr/bin/bash -e {0}
2025-08-17T19:54:46.3496838Z env:
2025-08-17T19:54:46.3496994Z   PYTHONPATH: app
2025-08-17T19:54:46.3497183Z   AWS_DEFAULT_REGION: us-east-1
2025-08-17T19:54:46.3497437Z   TEST_API_KEY: test-api-key-12345
2025-08-17T19:54:46.3497665Z   LOG_LEVEL: DEBUG
2025-08-17T19:54:46.3497898Z   pythonLocation: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:46.3498344Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib/pkgconfig
2025-08-17T19:54:46.3498733Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:46.3499055Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:46.3499384Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:46.3499718Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib
2025-08-17T19:54:46.3499990Z ##[endgroup]
2025-08-17T19:54:46.3557999Z Starting SAM local API...
2025-08-17T19:54:46.3560119Z Waiting for local API to start...
2025-08-17T19:54:46.3624092Z Local API is ready
2025-08-17T19:54:46.3624534Z Running integration tests against local API...
2025-08-17T19:54:46.5740143Z ============================= test session starts ==============================
2025-08-17T19:54:46.5741228Z platform linux -- Python 3.11.13, pytest-8.4.1, pluggy-1.6.0 -- /home/runner/work/product-selector/product-selector/.venv/bin/python
2025-08-17T19:54:46.5742130Z cachedir: .pytest_cache
2025-08-17T19:54:46.5742647Z rootdir: /home/runner/work/product-selector/product-selector
2025-08-17T19:54:46.5743245Z configfile: pyproject.toml
2025-08-17T19:54:46.5743849Z plugins: anyio-4.10.0
2025-08-17T19:54:46.9742605Z collecting ... collected 0 items / 1 error
2025-08-17T19:54:46.9743449Z 
2025-08-17T19:54:46.9743857Z ==================================== ERRORS ====================================
2025-08-17T19:54:46.9744619Z _________ ERROR collecting lambda/tests/integration/test_local_api.py __________
2025-08-17T19:54:46.9745941Z ImportError while importing test module '/home/runner/work/product-selector/product-selector/lambda/tests/integration/test_local_api.py'.
2025-08-17T19:54:46.9747170Z Hint: make sure your test modules/packages have valid Python names.
2025-08-17T19:54:46.9747690Z Traceback:
2025-08-17T19:54:46.9748724Z /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/importlib/__init__.py:126: in import_module
2025-08-17T19:54:46.9749705Z     return _bootstrap._gcd_import(name[level:], package, level)
2025-08-17T19:54:46.9750301Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-17T19:54:46.9750817Z tests/integration/test_local_api.py:27: in <module>
2025-08-17T19:54:46.9751482Z     from test_deployed_lambda import _resolve_region, _resolve_function_name
2025-08-17T19:54:46.9752229Z E   ModuleNotFoundError: No module named 'test_deployed_lambda'
2025-08-17T19:54:46.9753253Z - generated xml file: /home/runner/work/product-selector/product-selector/lambda/test-results-integration.xml -
2025-08-17T19:54:46.9754434Z =========================== short test summary info ============================
2025-08-17T19:54:46.9755018Z ERROR tests/integration/test_local_api.py
2025-08-17T19:54:46.9755650Z !!!!!!!!!!!!!!!!!!!! Interrupted: 1 error during collection !!!!!!!!!!!!!!!!!!!!
2025-08-17T19:54:46.9756264Z =============================== 1 error in 0.37s ===============================
2025-08-17T19:54:47.2515084Z No current session found, using default AWS::AccountId
2025-08-17T19:54:47.3090752Z Initializing the lambda functions containers.
2025-08-17T19:54:47.5058798Z Local image was not found.
2025-08-17T19:54:47.5060453Z Removing rapid images for repo public.ecr.aws/sam/emulation-python3.11
2025-08-17T19:54:52.0180208Z ##[error]Process completed with exit code 2.
2025-08-17T19:54:52.0257203Z ##[group]Run actions/upload-artifact@v4
2025-08-17T19:54:52.0257547Z with:
2025-08-17T19:54:52.0257719Z   name: test-results
2025-08-17T19:54:52.0258057Z   path: lambda/test-results-*.xml

2025-08-17T19:54:52.0258421Z   retention-days: 7
2025-08-17T19:54:52.0258747Z   if-no-files-found: warn
2025-08-17T19:54:52.0259061Z   compression-level: 6
2025-08-17T19:54:52.0259397Z   overwrite: false
2025-08-17T19:54:52.0259726Z   include-hidden-files: false
2025-08-17T19:54:52.0259960Z env:
2025-08-17T19:54:52.0260124Z   PYTHONPATH: app
2025-08-17T19:54:52.0260324Z   AWS_DEFAULT_REGION: us-east-1
2025-08-17T19:54:52.0260655Z   TEST_API_KEY: test-api-key-12345
2025-08-17T19:54:52.0260878Z   LOG_LEVEL: DEBUG
2025-08-17T19:54:52.0261128Z   pythonLocation: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:52.0261770Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib/pkgconfig
2025-08-17T19:54:52.0262376Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:52.0262861Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:52.0263357Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:52.0263882Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib
2025-08-17T19:54:52.0264278Z ##[endgroup]
2025-08-17T19:54:52.3095886Z With the provided path, there will be 2 files uploaded
2025-08-17T19:54:52.3102535Z Artifact name is valid!
2025-08-17T19:54:52.3104115Z Root directory input is valid!
2025-08-17T19:54:52.6044701Z Beginning upload of artifact content to blob storage
2025-08-17T19:54:52.9328672Z Uploaded bytes 1687
2025-08-17T19:54:53.0170958Z Finished uploading artifact content to blob storage!
2025-08-17T19:54:53.0174112Z SHA256 digest of uploaded artifact zip is 1d2c4e663b094212f9c834bca94ffa7fd7f605a184f1a60cd65bb099398fad5d
2025-08-17T19:54:53.0176015Z Finalizing artifact upload
2025-08-17T19:54:53.1465646Z Artifact test-results.zip successfully finalized. Artifact ID 3783748138
2025-08-17T19:54:53.1467374Z Artifact test-results has been successfully uploaded! Final size is 1687 bytes. Artifact ID is 3783748138
2025-08-17T19:54:53.1474724Z Artifact download URL: https://github.com/JimothyJohn/product-selector/actions/runs/17025210226/artifacts/3783748138
2025-08-17T19:54:53.1586261Z ##[group]Run actions/upload-artifact@v4
2025-08-17T19:54:53.1586527Z with:
2025-08-17T19:54:53.1586703Z   name: coverage-reports
2025-08-17T19:54:53.1586916Z   path: lambda/htmlcov/
lambda/.coverage

2025-08-17T19:54:53.1587167Z   retention-days: 7
2025-08-17T19:54:53.1587359Z   if-no-files-found: warn
2025-08-17T19:54:53.1587558Z   compression-level: 6
2025-08-17T19:54:53.1587745Z   overwrite: false
2025-08-17T19:54:53.1587935Z   include-hidden-files: false
2025-08-17T19:54:53.1588135Z env:
2025-08-17T19:54:53.1588301Z   PYTHONPATH: app
2025-08-17T19:54:53.1588494Z   AWS_DEFAULT_REGION: us-east-1
2025-08-17T19:54:53.1588716Z   TEST_API_KEY: test-api-key-12345
2025-08-17T19:54:53.1588943Z   LOG_LEVEL: DEBUG
2025-08-17T19:54:53.1589201Z   pythonLocation: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:53.1589607Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib/pkgconfig
2025-08-17T19:54:53.1589988Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:53.1590363Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:53.1590703Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-17T19:54:53.1591049Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib
2025-08-17T19:54:53.1591336Z ##[endgroup]
2025-08-17T19:54:53.3738967Z Multiple search paths detected. Calculating the least common ancestor of all paths
2025-08-17T19:54:53.3742133Z The least common ancestor is /home/runner/work/product-selector/product-selector/lambda. This will be the root directory of the artifact
2025-08-17T19:54:53.3753955Z ##[warning]No files were found with the provided path: lambda/htmlcov/
lambda/.coverage. No artifacts will be uploaded.
2025-08-17T19:54:53.3857646Z Post job cleanup.
2025-08-17T19:54:53.4803700Z [command]/usr/bin/git version
2025-08-17T19:54:53.4839709Z git version 2.50.1
2025-08-17T19:54:53.4880927Z Temporarily overriding HOME='/home/runner/work/_temp/1ce4e275-913e-4a3b-8006-b419715efaa2' before making global git config changes
2025-08-17T19:54:53.4882151Z Adding repository directory to the temporary git global config as a safe directory
2025-08-17T19:54:53.4886792Z [command]/usr/bin/git config --global --add safe.directory /home/runner/work/product-selector/product-selector
2025-08-17T19:54:53.4985032Z [command]/usr/bin/git config --local --name-only --get-regexp core\.sshCommand
2025-08-17T19:54:53.5024901Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'core\.sshCommand' && git config --local --unset-all 'core.sshCommand' || :"
2025-08-17T19:54:53.5449304Z [command]/usr/bin/git config --local --name-only --get-regexp http\.https\:\/\/github\.com\/\.extraheader
2025-08-17T19:54:53.5475304Z http.https://github.com/.extraheader
2025-08-17T19:54:53.5488194Z [command]/usr/bin/git config --local --unset-all http.https://github.com/.extraheader
2025-08-17T19:54:53.5904126Z [command]/usr/bin/git submodule foreach --recursive sh -c "git config --local --name-only --get-regexp 'http\.https\:\/\/github\.com\/\.extraheader' && git config --local --unset-all 'http.https://github.com/.extraheader' || :"
2025-08-17T19:54:53.6253079Z Cleaning up orphan processes
2025-08-17T19:54:53.6532685Z Terminate orphan process: pid (2253) (sam)
